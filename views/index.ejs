<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.css" crossorigin="anonymous">
		<link rel="stylesheet" href="stylesheets/style.css">
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<script type="text/javascript">
		google.charts.load('current', {
        'packages':['geochart'],
        'mapsApiKey': 'AIzaSyD4G8iqHb0uqvI2fWVyEYNJHOzQvVMjKng'
      });
      google.charts.setOnLoadCallback(drawRegionsMap);
		
      function drawRegionsMap() {
        var data = google.visualization.arrayToDataTable([
          ['Country'],
			<% locations.forEach(function(location) { %>
				['<%= location.country %>'],
			<% }); %>
        ]);

        var options = {};

        var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

        chart.draw(data, options);
      }
		</script>
		<title>Traveler's Check Map</title>
	</head>
	<body>

	<div id="landscape">
		<div class="container">	
			
			<!-- Grid to manage screen layout -->
			<div class="ui grid">
				
				<!-- Sidebar -->
				<div class="three wide column">
					<div class="ui bottom attached segment pushable">
						<div id="sideNav" class="ui visible inverted left vertical sidebar menu">
							<a class="item" href="/map/new">
							  <i class="home icon"></i>
							  Add a Country
							</a>
							<a class="item">
							  <i class="block layout icon"></i>
							  Remove a Country
							</a>
							<div id="bar-bottom">
								<% if(!currentUser){ %>
								<a class="item bottm" href="/login">Login</a>
								<a class="item bottm" href="/register">Sign Up</a>
								<% } else { %>
								<a class="item bottm" href="#">Signed In as <%= currentUser.username %></a>
								<a class="item bottm" href="/logout">Logout</a>
								<% } %>
							</div>
						</div>
					</div>
				</div>
				
				<!-- Rendering the google GeoChart map-->
				<div class="thirteen wide column">
				  <div class="pusher">
					<div class="ui basic segment">
						<div id="regions_div"></div>
					</div>
				  </div>
				</div>
				
			</div>
		</div>
	</div>


	<div id="portrait">
		<div class="container">
			<!-- User label -->
			<div class="ui blue label">
			  <i class="user circle icon"></i> <%= currentUser.username %>
			</div>
			
			<h3>
				My Stats
			</h3>
				<h4>
					There are 195 countries in the world	
				</h4>
				<h4>
					I visited 
						<% var count = 0; %>
						<% for ( i = 0; i < locations.length; i++){ %>
						<% count++; %>
						<% } %>
						<%= count %>
					 countries
				</h4>
				<h4>
					<% var countriesLeft = 195-count %>
					<%= countriesLeft %> countries left for me to visit
				</h4>
				<h4>
					<% var countriesPercent = Math.round(100 * (count/195)) %>
					<%= countriesPercent %>% of countries explored
				</h4>
			<h3>
				Countries I've been to:
			</h3>	
			<ul>
				<% locations.forEach(function(location){ %>
					<li> <%= location.country %>
						<form class="deleteForm" action="/map/<%= location._id %>?_method=DELETE" method="POST">
							<button class="btn btn-xs btn-danger"><i class="close icon"></i></button>
						</form>
					</li>
				<% }); %>

			</ul>
		</div>
	</div>




<% include partials/footer %>