<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="stylesheets/style.css">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
		<script
		  src="https://code.jquery.com/jquery-1.12.4.js"
		  integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU="
		  crossorigin="anonymous">
		</script>
		<script type="text/javascript" src="javascript/script.js"></script>
		<script src="https://kit.fontawesome.com/e042c340d4.js" crossorigin="anonymous"></script>
		<!-- Google GeoChart API -->
		<link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<script type="text/javascript">
		google.charts.load('current', {
        'packages':['geochart'],
        'mapsApiKey': 'AIzaSyD4G8iqHb0uqvI2fWVyEYNJHOzQvVMjKng'
      });
      google.charts.setOnLoadCallback(drawRegionsMap);
		
      function drawRegionsMap() {
        var data = google.visualization.arrayToDataTable([
          ['Country'],
			<% locations.forEach(function(location) { %>
				['<%= location.country %>'],
			<% }); %>
        ]);

        var options = {};

        var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

        chart.draw(data, options);
      }
		</script>
	</head>
	<body>
		
<div id="landscape">
	<div class="container-fluid">
		<div class="row">
			<div id="side-bar" class="col-2">
				<div class="add-location">
					<a href="/map/new">
					<i id="globe-btn" class="fas fa-globe-americas"></i>
					<p>
						Add a country
					</p>
					</a>
				</div>
				<% if(!currentUser){ %>
				<h3>
					Please 
					<a href="/login">Login</a>
					or
					<a href="/register">Sign Up</a>
				</h3>				
				<% } else { %>
				<h3>
					Hi, <%= currentUser.username %>
				</h3>
				
				<div class="logout-button">
					<a href="/logout">Logout <i class="fas fa-sign-out-alt"></i></a>
				</div>
				<% } %>
			</div>
			<!-- Rendering the google GeoChart map-->
			<div id="map-div" class="col-10">
				<div id="regions_div"></div>
			</div>
		</div>
	</div>
</div>

<div id="portrait">
	<div class="container">
			<h4>
				There are <span>195</span> countries in the world	
			</h4>
			<h4>
				I've been to 
					<% var count = 0; %>
					<% for ( i = 0; i < locations.length; i++){ %>
					<% count++; %>
					<% } %>
					<span><%= count %></span>
			</h4>
			<h4>
				That is
				<% var countriesPercent = Math.round(100 * (count/195)) %>
				<span><%= countriesPercent %>%</span> of countries explored
			</h4>
			<h4>
				<% var countriesLeft = 195-count %>
				<span><%= countriesLeft %></span> left for me to visit
			</h4>

		<h3>
			Explored countries:
		</h3>
		
		<ul class="list-group list-group-flush">
			<% locations.forEach(function(location){ %>
			<div>
				<li class="list-group-item"><%= location.country %>
					<div class="country-delete">
						<form class="deleteForm" action="/map/<%= location._id %>?_method=DELETE" method="POST">
								<input type="submit" class="btn btn-outline-danger" value="X">
						</form>
					</div>
				</li>
			</div>
			<% }) %>
		</ul>
	</div>
</div>

<% include partials/footer %>